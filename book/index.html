<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<meta http-equiv="Content-Language" content="en-gb">
	<link href="../stylesheet.css" rel="stylesheet">
	<link rel="icon" href="../docs/hearthwell.png">
	<title>Book of the Well</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script>

		$(document).ready(function () {
			category("introduction", ["asul", "basestuff", "crystals", "displacer", "dusts", "soulsteel", "trees"]);
			category("core_mechanics", ["charging", "collecting_light", "coring", "crushing", "dustpicking",
				"freezing", "grinding", "power", "separator", "stabilising", "tubing"]);
		});

		function category(name, elems) {
			var cat_div = $("<div class='tab' id='" + name + "'></div>");
			var basepath = "patchouli_book/en_us/";
			$.getJSON(basepath + "categories/" + name + ".json", function (cat_data) {
				$('<h2 class="tablink" onclick="changeTab(event, \'' + name + '\')">' + cat_data.name + '</h2>')
					.appendTo(cat_div);
			});

			elems.forEach(element => {
				$.getJSON(basepath + "entries/" + name + "/" + element + ".json", function (elem_data) {
					console.log(elem_data);
					$('<h3>' + element + '</h3>').appendTo(cat_div);
					elem_data.pages.forEach(page => {
						if ("text" in page) {
							// if (page.type == "text" || page.type == "spotlight" || page.type == "text" || ) {
							$('<p>' + page.text + '</p>')
								.appendTo(".tablinks");
						}
					});

				});
			});
			cat_div.appendTo("tabs");
		}

		function changeTab(evt, name) {
			var i, tab, tablinks;
			tab = document.getElementsByClassName("tab");
			for (i = 0; i < tab.length; i++) { tab[i].style.display = "none"; }
			tablinks = document.getElementsByClassName("tablink");
			for (i = 0; i < tablinks.length; i++) {
				tablinks[i].className = tablinks[i].className.replace(" active", "");
			}
			document.getElementById(name).style.display = "block";
			evt.currentTarget.className += " active";
		}

	</script>

	<style>
		:root {
			--size_left: 128px;
		}

		.tablinks {
			border-top-color: #999999;
			margin: 50px;
			height: 44px;
		}

		.tablinks h3 {
			border-top: solid 1px #CCC;
			border-left: solid 1px #CCC;
			border-bottom: solid 1px #999;
			border-right: solid 1px #999;
			padding: 10px;
			margin: 0 10px 0 0;
		}

		.tab {
			/* left: var(--size_left); */
			clear: both;
			/* margin-top: 50px; */
			display: none;
		}

		.tablink {
			float: left;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

		.tablink.active {
			background-color: #DDDDDD;
		}

		.tablink:hover {
			background-color: #DDDDEE;
		}
	</style>
</head>

<body>
	<object style="border:0;padding:0;width:100%" type="text/html" data="../navbar.html"></object>
	<hr>
	<!-- <h1>Book of the Well</h1> -->
	<div class="tablinks"></div>
	<div class="tabs"></div>

</body>

</html>